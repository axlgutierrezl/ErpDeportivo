import{h as u,aO as Z,g as h,p as f,s as ee,f as ae,b as r,w as i,u as d,c as S,j as B,F as oe,z as I,o as x,q as le,k as R,t as re}from"./app.50683a97.js";import{T as te}from"./TenantLayout.4c67b316.js";import{C as ie}from"./CardView.5dc7dcb1.js";import{_ as de}from"./AddEditAlmacen.520f03c1.js";import{_ as se}from"./AddEditCategoria.39774cac.js";import{_ as ne}from"./AddEditMarca.8ec0a6e0.js";import{V as ue}from"./VBreadcrumbs.c34b1911.js";import{V as me}from"./VForm.9f532f63.js";import{V as ce}from"./VCheckbox.abce29f0.js";import{a as g,b as n,V as j}from"./index.4549214f.js";import{V as _}from"./VTextField.65545f13.js";import{V as pe}from"./VTextarea.d8f411ef.js";import{V as U}from"./VCombobox.494f4cab.js";import{p as fe,h as ve}from"./VNavigationDrawer.8088819a.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./DialogFormModal.e18ee1c1.js";import"./VDialog.52eddf4b.js";import"./VCheckboxBtn.fafb4134.js";import"./VSelect.1e68f7fa.js";import"./VChip.0d8836c3.js";const Pe={__name:"CreateEdit",props:["getTables","flash","producto"],setup(D){const t=D,b=u(!1),V=u(!1),k=u(!1),C=u(null),y=u(null),w=u(null),T=u(null),m=u([]),c=u([]),p=u([]),v=u([]),A=u(!1),M=Z(),e=h({id:0,almacen_id:null,categoria_id:null,marca_id:null,nombre:"",descripcion:"",codigo_barra:"",precio_venta:"",precio_compra:"",stock:"",stock_minimo:"",unidad_medida:null,estado:"ACTIVO",registrando:!1});function E(){I.Inertia.reload({only:["getTables"],onSuccess:()=>{if(p.value=t.getTables.almacenes,c.value=t.getTables.categorias,m.value=t.getTables.marcas,v.value=t.getTables.unidadMedidas,t.producto){let l=v.value.find(s=>s.simbolo===t.producto.unidad_medida),a=v.value.findIndex(s=>s.simbolo===t.producto.unidad_medida),o=v.value[0];v.value.splice(0,1,l),v.value.splice(a,1,o);let z=m.value.find(s=>s.id===t.producto.marca_id),q=m.value.findIndex(s=>s.id===t.producto.marca_id),H=m.value[0];m.value.splice(0,1,z),m.value.splice(q,1,H);let J=p.value.find(s=>s.id===t.producto.almacen_id),K=p.value.findIndex(s=>s.id===t.producto.almacen_id),Q=p.value[0];p.value.splice(0,1,J),p.value.splice(K,1,Q);let W=c.value.find(s=>s.id===t.producto.categoria_id),X=c.value.findIndex(s=>s.id===t.producto.categoria_id),Y=c.value[0];c.value.splice(0,1,W),c.value.splice(X,1,Y)}}})}function P(){I.Inertia.reload({only:["getTables"],onSuccess:()=>{p.value=t.getTables.almacenes}})}function $(){I.Inertia.reload({only:["getTables"],onSuccess:()=>{c.value=t.getTables.categorias}})}function F(){I.Inertia.reload({only:["getTables"],onSuccess:()=>{m.value=t.getTables.marcas}})}function L(){let l=e.id==0?route("tenant.almacen.productos.store"):route("tenant.almacen.productos.update",{producto:e.id}),a=e.id==0?"post":"put";e[a](l,{errorBag:"newProducto",onError:()=>{Object.entries(e.errors).length>0&&(A.value=!0)},onSuccess:()=>{t.flash.success&&(M.success(t.flash.success),e.reset(),e.clearErrors(),e.registrando=!0,E()),t.flash.error&&M.error(t.flash.error)}})}function N(){b.value=!0}function G(){V.value=!0}function O(){k.value=!0}return f(p,l=>{let a=t.producto;C.value=a?l.find(o=>o.id===a.almacen_id):l.length>0?l[0]:null}),f(v,l=>{let a=t.producto;y.value=a?l.find(o=>o.simbolo===a.unidad_medida):l.length>0?l[0]:null}),f(c,l=>{let a=t.producto;w.value=a?l.find(o=>o.id===a.categoria_id):l.length>0?l[0]:null}),f(m,l=>{let a=t.producto;T.value=a?l.find(o=>o.id===a.marca_id):l.length>0?l[0]:null}),f(C,l=>{e.almacen_id=l?l.id:null,l&&delete e.errors.almacen_id}),f(y,l=>{e.unidad_medida=l?l.simbolo:null,l&&delete e.errors.unidad_medida}),f(w,l=>{e.categoria_id=l?l.id:null,l&&delete e.errors.categoria_id}),f(T,l=>{e.marca_id=l?l.id:null,l&&delete e.errors.marca_id}),f(e,l=>{for(let a in l)if(a!="errors")for(let o in e.errors)a!="categoria_id"&&a!="almacen_id"&&a!="marca_id"&&a!="unidad_medida"&&o==a&&l[a]!=""&&(A.value||delete e.errors[o]);A.value=!1},{deep:!0}),ee(()=>{E(),t.producto&&(e.nombre=t.producto.nombre,e.precio_compra=t.producto.precio_compra,e.precio_venta=t.producto.precio_venta,e.stock=t.producto.stock,e.stock_minimo=t.producto.stock_minimo,e.codigo_barra=t.producto.codigo_barra,e.id=t.producto.id,e.descripcion=t.producto.descripcion)}),(l,a)=>(x(),ae(oe,null,[r(te,{title:d(e).id==0?"Crear":"Editar",titleBread:d(e).id==0?"Registrar productos":"Editar producto"},{itemBreadCrumb:i(()=>[r(ue,{items:["Almacen","Productos",d(e).id==0?"Registro":"Editar"],class:"pa-0"},null,8,["items"])]),default:i(()=>[r(me,{onSubmit:le(L,["prevent"])},{default:i(()=>[r(ie,null,{title:i(()=>[r(ce,{"hide-details":"",modelValue:d(e).registrando,"onUpdate:modelValue":a[0]||(a[0]=o=>d(e).registrando=o),label:"Seguir registrando"},null,8,["modelValue"])]),content:i(()=>[r(g,null,{default:i(()=>[r(n,{cols:"12",md:"7"},{default:i(()=>[r(g,null,{default:i(()=>[r(n,{cols:"12",md:"12"},{default:i(()=>[r(_,{"error-messages":d(e).errors.nombre,modelValue:d(e).nombre,"onUpdate:modelValue":a[1]||(a[1]=o=>d(e).nombre=o),label:"Nombre",variant:"outlined",density:"compact"},null,8,["error-messages","modelValue"])]),_:1})]),_:1}),r(g,null,{default:i(()=>[r(n,{cols:"12",md:"12"},{default:i(()=>[r(pe,{rows:"2",modelValue:d(e).descripcion,"onUpdate:modelValue":a[2]||(a[2]=o=>d(e).descripcion=o),density:"compact",variant:"outlined",label:"Descripci\xF3n"},null,8,["modelValue"])]),_:1})]),_:1}),r(g,null,{default:i(()=>[r(n,{cols:"12",md:"6"},{default:i(()=>[r(U,{"error-messages":d(e).errors.almacen_id,modelValue:C.value,"onUpdate:modelValue":a[3]||(a[3]=o=>C.value=o),clearable:"",items:p.value,"return-object":"","item-value":"id","item-title":"descripcion",density:"compact",variant:"outlined",label:"Almac\xE9n","append-icon":"mdi:mdi-plus","onClick:append":N},null,8,["error-messages","modelValue","items"])]),_:1}),r(n,{cols:"12",md:"6"},{default:i(()=>[r(U,{modelValue:y.value,"onUpdate:modelValue":a[4]||(a[4]=o=>y.value=o),"error-messages":d(e).errors.unidad_medida,clearable:"",items:v.value,"return-object":"","item-value":"simbolo","item-title":"descripcion",density:"compact",variant:"outlined",label:"Unidad de medida"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),r(g,null,{default:i(()=>[r(n,{cols:"12",md:"6"},{default:i(()=>[r(U,{modelValue:w.value,"onUpdate:modelValue":a[5]||(a[5]=o=>w.value=o),"error-messages":d(e).errors.categoria_id,clearable:"",items:c.value,"return-object":"","item-value":"id","item-title":"descripcion",density:"compact",variant:"outlined",label:"Categoria","append-icon":"mdi:mdi-plus","onClick:append":G},null,8,["modelValue","error-messages","items"])]),_:1}),r(n,{cols:"12",md:"6"},{default:i(()=>[r(U,{"error-messages":d(e).errors.marca_id,modelValue:T.value,"onUpdate:modelValue":a[6]||(a[6]=o=>T.value=o),clearable:"",items:m.value,"return-object":"","item-value":"id","item-title":"nombre",density:"compact",variant:"outlined",label:"Marca","append-icon":"mdi:mdi-plus","onClick:append":O},null,8,["error-messages","modelValue","items"])]),_:1})]),_:1})]),_:1}),r(n,{cols:"12",md:"5"},{default:i(()=>[r(g,null,{default:i(()=>[r(n,{cols:"12",md:"6"},{default:i(()=>[r(_,{"error-messages":d(e).errors.precio_venta,modelValue:d(e).precio_venta,"onUpdate:modelValue":a[7]||(a[7]=o=>d(e).precio_venta=o),label:"Precio Venta",variant:"outlined",density:"compact"},null,8,["error-messages","modelValue"])]),_:1}),r(n,{cols:"12",md:"6"},{default:i(()=>[r(_,{"error-messages":d(e).errors.precio_compra,modelValue:d(e).precio_compra,"onUpdate:modelValue":a[8]||(a[8]=o=>d(e).precio_compra=o),label:"Precio Compra",variant:"outlined",density:"compact"},null,8,["error-messages","modelValue"])]),_:1})]),_:1}),r(g,null,{default:i(()=>[r(n,{cols:"12",md:"6"},{default:i(()=>[r(_,{"error-messages":d(e).errors.stock,modelValue:d(e).stock,"onUpdate:modelValue":a[9]||(a[9]=o=>d(e).stock=o),label:"Stock",variant:"outlined",density:"compact"},null,8,["error-messages","modelValue"])]),_:1}),r(n,{cols:"12",md:"6"},{default:i(()=>[r(_,{"error-messages":d(e).errors.stock_minimo,modelValue:d(e).stock_minimo,"onUpdate:modelValue":a[10]||(a[10]=o=>d(e).stock_minimo=o),label:"Stock minimo",variant:"outlined",density:"compact"},null,8,["error-messages","modelValue"])]),_:1})]),_:1}),r(g,null,{default:i(()=>[r(n,{cols:"12",md:"6"},{default:i(()=>[r(_,{"error-messages":d(e).errors.codigo_barra,modelValue:d(e).codigo_barra,"onUpdate:modelValue":a[11]||(a[11]=o=>d(e).codigo_barra=o),label:"Codigo de barra",variant:"outlined",density:"compact"},null,8,["error-messages","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),actions:i(()=>[r(fe,null,{default:i(()=>[r(ve),r(j,{onClick:a[12]||(a[12]=o=>l.$inertia.visit(l.route("tenant.almacen.productos.index")))},{default:i(()=>[R("Regresar")]),_:1}),r(j,{type:"submit"},{default:i(()=>[R(re(d(e).id==0?"Guardar":"Actualizar"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["title","titleBread"]),b.value?(x(),S(de,{key:0,show:b.value,"onUpdate:show":a[13]||(a[13]=o=>b.value=o),onAddingAlmacen:P},null,8,["show"])):B("",!0),V.value?(x(),S(se,{key:1,show:V.value,"onUpdate:show":a[14]||(a[14]=o=>V.value=o),onAddingCategoria:$},null,8,["show"])):B("",!0),k.value?(x(),S(ne,{key:2,show:k.value,"onUpdate:show":a[15]||(a[15]=o=>k.value=o),onAddingMarca:F},null,8,["show"])):B("",!0)],64))}};export{Pe as default};
